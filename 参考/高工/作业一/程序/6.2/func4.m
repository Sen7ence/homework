function [func4]=func4(T4,P4,Z)
R=8.3145;
M4=114.04e-3;
Tc4=382.52;
Pc4=3.6363e6;
w4=0.313;
Tr4=T4/Tc4;
k4=0.37464+1.54226*w4-0.26992*w4^2;
al4=(1+k4*(1-Tr4^0.5))^2;
a4=0.45724*al4*(R^2)*(Tc4^2)/Pc4;
b4=0.07780*R*Tc4/Pc4;
A4=a4*P4/((R^2)*(T4^2));
B4=b4*P4/(R*T4);
Z=new(A4,B4,Z);
func4=exp(Z-1-log(Z-B4)-A4*log((Z+2.414*B4)/(Z-0.414*B4))/(2*sqrt(2)*B4));
end