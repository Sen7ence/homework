import plotly.graph_objects as go

# 1) 所有节点（方框）名字：按系统流程列出来就行
labels = [
    "电网",  # 0
    "热源水",  # 1
    "蒸发器",  # 2
    "压缩机",  # 3
    "冷凝器",  # 4
    "蒸汽用户",  # 5 有用㶲
    "㶲损失-蒸发器",  # 6
    "㶲损失-压缩机",  # 7
    "㶲损失-冷凝器",  # 8
]

# 2) 每一条㶲流：起点(source)、终点(target)、数值(value)
source = [
    0,  # 电网 -> 压缩机
    1,  # 热源水 -> 蒸发器
    2,  # 蒸发器 -> 冷凝器（工质㶲）
    3,  # 压缩机 -> 冷凝器（工质㶲）
    4,  # 冷凝器 -> 蒸汽用户（有效㶲）
    2,  # 蒸发器 -> 蒸发器㶲损失
    3,  # 压缩机 -> 压缩机㶲损失
    4,  # 冷凝器 -> 冷凝器㶲损失
]

target = [
    3,  # 电网 -> 压缩机
    2,  # 热源水 -> 蒸发器
    4,  # 蒸发器 -> 冷凝器
    4,  # 压缩机 -> 冷凝器
    5,  # 冷凝器 -> 蒸汽用户
    6,  # 蒸发器 -> 蒸发器㶲损失
    7,  # 压缩机 -> 压缩机㶲损失
    8,  # 冷凝器 -> 冷凝器㶲损失
]

values = [
    100,  # 电功㶲
    80,  # 热源水㶲
    70,  # 蒸发器出口工质㶲
    90,  # 压缩机出口工质㶲
    120,  # 输送到蒸汽用户的有用㶲
    10,  # 蒸发器㶲损失
    20,  # 压缩机㶲损失
    10,  # 冷凝器㶲损失
]

# 3) 可选：给不同“类型”的流设置不同颜色
# 你可以根据需要修改：如电功=蓝色，热源㶲=绿色，损失=红色
link_colors = [
    "rgba(0, 0, 200, 0.6)",  # 电网 -> 压缩机（电功）
    "rgba(0, 150, 0, 0.6)",  # 热源水 -> 蒸发器
    "rgba(0, 150, 0, 0.6)",  # 蒸发器 -> 冷凝器
    "rgba(0, 150, 0, 0.6)",  # 压缩机 -> 冷凝器
    "rgba(255, 165, 0, 0.8)",  # 冷凝器 -> 蒸汽用户（有用㶲）
    "rgba(200, 0, 0, 0.6)",  # 蒸发器㶲损失
    "rgba(200, 0, 0, 0.6)",  # 压缩机㶲损失
    "rgba(200, 0, 0, 0.6)",  # 冷凝器㶲损失
]

# 4) 可选：固定节点位置，让整体看起来更“工艺流程化”
#  x, y 取值范围 0~1，左到右、下到上
node_x = [0.0, 0.0, 0.25, 0.25, 0.55, 0.85, 0.55, 0.55, 0.55]
node_y = [0.8, 0.2, 0.2, 0.8, 0.5, 0.5, 0.0, 0.15, 0.85]

fig = go.Figure(
    data=[
        go.Sankey(
            arrangement="fixed",  # 使用我们给的 x, y
            node=dict(pad=15, thickness=18, label=labels, x=node_x, y=node_y),
            link=dict(source=source, target=target, value=values, color=link_colors),
        )
    ]
)

fig.update_layout(title_text="某热泵系统㶲流桑基图（示例）", font=dict(size=12))
fig.show()
